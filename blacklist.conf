# geo directive to deny certain ip addresses
geo $validate_client {
  default                        0;

  # Cyveillance
  38.100.19.8/29                 1;
  38.100.21.0/24                 1;
  38.100.41.64/26                1;
  38.105.71.0/25                 1;
  38.105.83.0/27                 1;
  38.112.21.140/30               1;
  38.118.42.32/29                1;
  65.213.208.128/27              1;
  65.222.176.96/27               1;
  65.222.185.72/29               1;

  #Alexa
  204.236.235.245                1;
  75.101.186.145                 1;

  #Baidu
  119.63.196.0/24                1;
  115.239.212./24                1;
  119.63.199.0/24                1;
  122.81.208.0/22                1;
  123.125.71.0/24                1;
  180.76.4.0/24                  1;
  180.76.5.0/24 1;
  180.76.6.0/24 1;
  185.10.104.0/24 1;
  220.181.108.0/24 1;
  220.181.51.0/24 1;
  123.125.67.144/29 1;
  123.125.67.152/31 1;
  123.125.68.68/30 1;
  123.125.68.72/29 1;
  123.125.68.80/28 1;
  123.125.68.96/30 1;
  202.46.48.0/20 1;
  123.125.68.80/30 1;
  123.125.68.84/31 1;

  #Bing
  65.52.104.0/24 1;
  65.52.108.0/22 1;
  65.55.24.0/24 1;
  65.55.52.0/24 1;
  65.55.55.0/24 1;
  65.55.213.0/24 1;
  65.55.217.0/24 1;
  131.253.24.0/22 1;
  131.253.46.0/23 1;
  157.55.16.0/23 1;
  157.55.18.0/24 1;
  157.55.32.0/22 1;
  157.55.36.0/24 1;
  157.55.48.0/24 1;
  157.55.109.0/24 1;
  157.55.110.40/29 1;
  157.55.110.48/28 1;
  157.56.92.0/24 1;
  157.56.93.0/24 1;
  157.56.94.0/23 1;
  157.56.229.0/24 1;
  199.30.16.0/24 1;
  207.46.12.0/23 1;
  207.46.192.0/24 1;
  207.46.195.0/24 1;
  207.46.199.0/24 1;
  207.46.204.0/24 1;

  #Duckduck
  46.51.197.88 1;
  46.51.197.89 1;
  50.18.192.250 1;
  50.18.192.251 1;
  107.21.1.61 1;
  176.34.131.233 1;
  176.34.135.167 1;
  184.72.106.52 1;
  184.72.115.86 1;

  #Facebook
  31.13.97.0/24 1;
  31.13.99.0/24 1;
  31.13.100.0/24 1;
  66.220.144.0/20 1;
  69.63.189.0/24 1;
  69.63.190.0/24 1;
  69.171.224.0/20 1;
  69.171.240.0/21 1;
  69.171.248.0/24 1;
  173.252.73.0/24 1;
  173.252.74.0/24 1;
  173.252.77.0/24 1;
  173.252.100.0/22 1;
  173.252.104.0/21 1;
  173.252.112.0/24 1;

  #Google
  203.208.60.0/24 1;
  66.249.64.0/19 1;
  72.14.199.0/24 1;
  209.85.238.0/24 1;

  #Sogou
  220.181.125.0/24 1;
  123.126.51.64/27 1;
  123.126.51.96/28 1;
  123.126.68.25 1;
  61.135.189.74 1;
  61.135.189.75 1;

  #Yahoo
  67.195.37.0/24 1;
  67.195.50.0/24 1;
  67.195.110.0/24 1;
  67.195.111.0/24 1;
  67.195.112.0/23 1;
  67.195.114.0/24 1;
  67.195.115.0/24 1;
  68.180.224.0/24 1;
  72.30.132.0/24 1;
  72.30.142.0/24 1;
  72.30.161.0/24 1;
  72.30.196.0/24 1;
  72.30.198.0/24 1;
  74.6.8.0/24 1;
  74.6.13.0/24 1;
  74.6.17.0/24 1;
  74.6.18.0/24 1;
  74.6.22.0/24 1;
  74.6.27.0/24 1;
  98.137.72.0/24 1;
  98.137.206.0/24 1;
  98.137.207.0/24 1;
  98.139.168.0/24 1;
  114.111.95.0/24 1;
  124.83.159.0/24 1;
  124.83.179.0/24 1;
  124.83.223.0/24 1;
  183.79.63.0/24 1;
  183.79.92.0/24 1;
  203.216.255.0/24 1;
  211.14.11.0/24 1;

  #Yandex
  37.9.115.0/24 1;
  37.140.165.0/24 1;
  77.88.22.0/25 1;
  77.88.29.0/24 1;
  77.88.31.0/24 1;
  77.88.59.0/24 1;
  84.201.146.0/24 1;
  84.201.148.0/24 1;
  84.201.149.0/24 1;
  87.250.243.0/24 1;
  87.250.253.0/24 1;
  93.158.147.0/24 1;
  93.158.148.0/24 1;
  93.158.151.0/24 1;
  93.158.153.0/32 1;
  95.108.128.0/24 1;
  95.108.138.0/24 1;
  95.108.150.0/23 1;
  95.108.158.0/24 1;
  95.108.156.0/24 1;
  95.108.188.128/25 1;
  95.108.234.0/24 1;
  95.108.248.0/24 1;
  100.43.80.0/24 1;
  130.193.62.0/24 1;
  141.8.153.0/24 1;
  178.154.165.0/24 1;
  178.154.166.128/25 1;
  178.154.173.29 1;
  178.154.200.158 1;
  178.154.202.0/24 1;
  178.154.205.0/24 1;
  178.154.239.0/24 1;
  178.154.243.0/24 1;
  37.9.84.253 1;
  199.21.99.99 1;
  178.154.162.29 1;
  178.154.203.251 1;
  178.154.211.250 1;
  95.108.246.252 1;

  #Youdao
  61.135.249.200/29 1;
  61.135.249.208/28 1;
}

# map directive to check user-agent against bad bots, then
# checks client ip address to deny
map $http_user_agent $bad_client {
  default                        $validate_client;

  ~*(google|bing|yandex|msnbot|crawler|AltaVista|Slurp|BlackWidow|Bot|ChinaClaw|Custo|DISCo|Download|Demon|eCatch|EirGrabber|SuperHTTP|Express|WebPictures|Extractor|EyeNetIE|FlashGet|GetRight|GetWeb!|Go!Zilla|Go-Ahead-Got-It|GrabNet|Grafula|HMView|Go!Zilla|Go-Ahead-Got-It|rafula|HTTrack|Stripper|Sucker|Indy|InterGET|Ninja|JetCar|Spider|larbin|LeechFTP|tool|Navroad|NearSite|NetAnts|tAkeOut|WWWOFFLE|GrabNet|NetSpider|Vampire|NetZIP|Octopus|Offline|PageGrabber|Foto|pavuk|pcBrowser|ReGet|SiteSnagger|Teleport|VoidEYE|Collector|WebAuto|WebCopier|WebFetch|WebGo|WebLeacher|WebSauger|eXtractor|Quester|WebStripper|WebZIP|Wget|Widow|Zeus|Twengabot|htmlparser|libwww|Python|perl|urllib|scan|Curl|email|PycURL|Pyth|PyQ|WebCollector|WebCopy|webcraw|Aboundex|80legs|360Spider|Bandit|Buddy|Copier|Reaper|Recorder|Siphon|Whacker|ZmEu|Acunetix|Baiduspider) 1;
  "~*^Java"                      1;
  "~*^asterias"                  1;
  "~*^attach"                    1;
  "~*^BackWeb"                   1;
  "~*^BatchFTP"                  1;
  "~*^Bigfoot"                   1;
  "~*^Black.Hole"                1;
  "~*^BlowFish"                  1;
  "~*^Bullseye"                  1;
  "~*^BunnySlippers"             1;
  "~*^Cegbfeieh"                 1;
  "~*^CherryPicker"              1;
  "~*^CopyRightCheck"            1;
  "~*^cosmos"                    1;
  "~*^Crescent"                  1;
  "~*^DittoSpyder"               1;
  "~*^dragonfly"                 1;
  "~*^Drip"                      1;
  "~*^EasyDL"                    1;
  "~*^ebingbong"                 1;
  "~*^flunky"                    1;
  "~*^FrontPage"                 1;
  "~*^gotit"                     1;
  "~*^Harvest"                   1;
  "~*^hloader"                   1;
  "~*^humanlinks"                1;
  "~*^Image\ Stripper"           1;
  "~*^Image\ Sucker"             1;
  "~*^InfoTekies"                1;
  "~*^Intelliseek"               1;
  "~*^Iria"                      1;
  "~*^Jakarta"                   1;
  "~*^JOC"                       1;
  "~*^JustView"                  1;
  "~*^Keyword.Density"           1;
  "~*^lftp"                      1;
  "~*^libWeb/clsHTTP"            1;
  "~*^likse"                     1;
  "~*^LinkScan/8.1a.Unix"        1;
  "~*^LinkWalker"                1;
  "~*^lwp-trivial"               1;
  "~*^LWP::Simple"               1;
  "~*^Magnet"                    1;
  "~*^Mag-Net"                   1;
  "~*^MarkWatch"                 1;
  "~*^Mata.Hari"                 1;
  "~*^Memo"                      1;
  "~*^Microsoft.URL"             1;
  "~*^Microsoft\ URL\ Control"   1;
  "~*^MIIxpc"                    1;
  "~*^Mirror"                    1;
  "~*^Missigua\ Locator"         1;
  "~*^Mister\ PiX"               1;
  "~*^moget"                     1;
  "~*^Mozilla/3.Mozilla/2.01"    1;
  "~*^Mozilla.*NEWT"             1;
  "~*^NAMEPROTECT"               1;
  "~*^Netcraft"                  1;
  "~*^NetMechanic"               1;
  "~*^NG"                        1;
  "~*^NICErsPRO"                 1;
  "~*^Openfind"                  1;
  "~*^Papa\ Foto"                1;
  "~*^PHP\ version\ tracker"     1;
  "~*^Pockey"                    1;
  "~*^ProWebWalker"              1;
  "~*^Pump"                      1;
  "~*^QueryN.Metasearch"         1;
  "~*^RepoMonkey"                1;
  "~*^RMA"                       1;
  "~*^SlySearch"                 1;
  "~*^Snake"                     1;
  "~*^Snoopy"                    1;
  "~*^sogou"                     1;
  "~*^SpaceBison"                1;
  "~*^spanner"                   1;
  "~*^Sqworm"                    1;
  "~*^suzuran"                   1;
  "~*^Szukacz/1.4"               1;
  "~*^Telesoft"                  1;
  "~*^The.Intraformant"          1;
  "~*^TheNomad"                  1;
  "~*^Titan"                     1;
  "~*^turingos"                  1;
  "~*^URLy.Warning"              1;
  "~*^Vacuum"                    1;
  "~*^VCI"                       1;
  "~*^Web\ Sucker"               1;
  "~*^Webclipping.com"           1;
  "~*^WebEnhancer"               1;
  "~*^Website\ Quester"          1;
  "~*^Webster"                   1;
  "~*^WebStripper"               1;
  "~*^WWW-Collector-E"           1;
  "~*^Xaldon"                    1;
  "~*^Xenu"                      1;
  "~*^Zyborg"                    1;
}
